<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>مُعين — الخطة الأسبوعية</title>

    <link rel="icon" type="image/x-icon" href="assets/icons/favicon.ico" />
    <link rel="shortcut icon" href="assets/icons/favicon.ico" />
    <link rel="apple-touch-icon" href="assets/icons/logo.png" />

    <link
      href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
    <meta name="color-scheme" content="dark light" />

    <!-- تطبيق لون الثيم (مثل بقية الصفحات) -->
    <script>
      (function () {
        try {
          var c = localStorage.getItem("athar:theme");
          if (c) document.documentElement.style.setProperty("--primary", c);
        } catch (_) {}
      })();
    </script>

    <style>
      .muted {
        opacity: 0.85;
      }
      .card-day {
        border: 1px dashed rgba(59, 130, 246, 0.35);
        border-radius: 12px;
        padding: 12px;
        margin: 14px 0;
        background: var(--card, rgba(15, 23, 42, 0.7));
      }
      .day-head {
        display: flex;
        align-items: center;
        gap: 10px;
        margin: 0 0 6px;
      }
      .chips {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
      }
      .chip {
        border-radius: 999px;
        padding: 4px 10px;
        background: color-mix(in oklab, var(--primary, #3b82f6) 12%, #020617);
        font-size: 0.85rem;
      }
      .actions-row {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        align-items: center;
      }
      .btn.small {
        padding: 6px 10px;
        font-size: 0.9rem;
      }
      .canon-box {
        border-radius: 10px;
        padding: 10px 12px;
        background: rgba(15, 23, 42, 0.6);
        border: 1px solid rgba(148, 163, 184, 0.4);
        margin-bottom: 10px;
      }
      .canon-box h3 {
        margin: 0 0 6px;
        font-size: 1rem;
      }
      .canon-box ul {
        margin: 4px 0 6px;
        padding-left: 1.2rem;
      }
    </style>
  </head>
  <body>
    <div class="global-bg"></div>

    <!-- شريط التنقل -->
    <div id="navbar" data-component="components/navbar.html"></div>

    <header>
      <div class="hero">
        <h1 class="logo">مُعين</h1>
        <div class="tag">
          <span class="dot"></span> نُعينك على بناء خطة أسبوعية متكاملة تنطلق من
          أهداف الدرس.
        </div>
      </div>
    </header>

    <main>
      <div class="container">
        <section class="card">
          <h2 class="title" style="margin-top: 0">مدخلات الخطة الأسبوعية</h2>
          <p class="muted">
            أدخل مادة الدرس، والصف، وعدد الدروس هذا الأسبوع، ثم اكتب أسماء
            الدروس كما هي في المنهج؛ وسيتولى "مُعين" توزيع أهداف كل درس على
            أيام الأسبوع مع مفردات ونتائج وواجب منزلي مقترح.
          </p>

          <div class="grid" style="grid-template-columns: 1fr 1fr">
            <div class="field">
              <label>المرحلة/الصف</label>
              <select id="f-grade">
                <option value="اول ابتدائي">أول ابتدائي</option>
                <option value="ثاني ابتدائي">ثاني ابتدائي</option>
                <option value="ثالث ابتدائي">ثالث ابتدائي</option>
                <option value="رابع ابتدائي">رابع ابتدائي</option>
                <option value="خامس ابتدائي">خامس ابتدائي</option>
                <option value="سادس ابتدائي">سادس ابتدائي</option>
                <option value="اول متوسط">أول متوسط</option>
                <option value="ثاني متوسط">ثاني متوسط</option>
                <option value="ثالث متوسط">ثالث متوسط</option>
                <option value="اول ثانوي">أول ثانوي</option>
                <option value="ثاني ثانوي">ثاني ثانوي</option>
                <option value="ثالث ثانوي" selected>ثالث ثانوي</option>
              </select>
            </div>

            <div class="field">
              <label>المادة : </label>
              <input
                id="f-subject"
                placeholder="مثلًا: فيزياء — الزخم والطاقة / رياضيات — حل المعادلات..."
              />
            </div>

            <div class="field">
              <label>عدد دروس الأسبوع</label>
              <select id="f-count">
                <option>1</option>
                <option>2</option>
                <option selected>3</option>
                <option>4</option>
                <option>5</option>
              </select>
            </div>
          </div>

          <!-- أسماء الدروس -->
          <div
            id="lessons-box"
            class="grid"
            style="grid-template-columns: 1fr; gap: 10px; margin-top: 8px"
          ></div>

          <div class="actions-row" style="margin-top: 10px">
            <button id="btn-generate" class="btn primary">ولّدي الخطة</button>
            <button id="btn-copy-all" class="btn" disabled>
              نسخ الخطة كاملة
            </button>
            <span id="status" class="muted"></span>
          </div>
        </section>

        <section class="card" id="out" style="display: none">
          <h2 class="title">الخطة الأسبوعية</h2>

          <div id="meta" class="chips" style="margin-bottom: 8px"></div>

          <!-- ملخص أهداف ومفردات كل درس -->
          <div id="canon" class="canon-box" style="display: none">
            <h3>ملخص أهداف الدروس ومفرداتها</h3>
            <div>
              <strong>الأهداف الأساسية:</strong>
              <ul id="canon-goals"></ul>
            </div>
            <div>
              <strong>المفردات الأساسية:</strong>
              <ul id="canon-vocab"></ul>
            </div>
          </div>

          <div id="plan"></div>
        </section>
      </div>
    </main>

    <!-- الفوتر المشترك -->
    <div id="footer" data-component="components/footer.html"></div>

    <div class="toast" id="toast"></div>

    <script>
      (function () {
        var y = document.getElementById("year");
        if (y) y.textContent = new Date().getFullYear();
        window.addEventListener("athar:theme-color", function (e) {
          try {
            if (e && e.detail) {
              document.documentElement.style.setProperty("--primary", e.detail);
            }
          } catch (_) {}
        });
      })();
    </script>

    <!-- سكربت مُعين -->
    <script src="assets/js/mueen.js"></script>

    <!-- Auth0 SDK (مع فولباك محلي) -->
    <script
      defer
      src="https://cdn.auth0.com/js/auth0-spa-js/2.1/auth0-spa-js.production.js"
      onerror="this.onerror=null;this.src='/assets/vendor/auth0-spa-js.production.js'"
    ></script>

    <!-- Supabase -->
    <script defer src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script defer src="/assets/js/supabase-client.js"></script>

    <!-- مكوّنات مشتركة -->
    <script src="assets/js/component-loader.js"></script>
    <script src="assets/js/navbar.js"></script>
    <!-- الحماية -->
    <script defer src="/assets/js/require-auth.js"></script>
    <script defer src="/app.js"></script>
  </body>
</html>
