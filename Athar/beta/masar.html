<!-- masar.html — صفحة "مَسار" (نسخة مُحدّثة وكاملة) -->
<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>مَســار — جداول حصص أنيقة</title>
    <meta name="color-scheme" content="dark light" />
    <link rel="icon" type="image/x-icon" href="assets/icons/favicon.ico" />
    <link rel="shortcut icon" href="assets/icons/favicon.ico" />
    <link rel="apple-touch-icon" href="assets/icons/logo.png" />
    <link
      href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />

    <link rel="stylesheet" href="assets/css/masar.css" />
  </head>
  <body>
    <div class="global-bg"></div>

    <!-- navbar component -->
    <div id="navbar" data-component="components/navbar.html"></div>

    <!-- الهيدر (هذا سيظهر في الطباعة) -->
    <header>
      <div class="hero">
        <h1 class="logo">مَســار</h1>
        <div class="tag">
          <span class="dot"></span> بترتيب الخطى تُـــدرَكُ الأهــداف .
        </div>
      </div>
    </header>

    <main class="container">
      <!-- الضوابط -->
      <section class="card controls">
        <h2 class="title" style="margin-top: 0">إعداد الجدول</h2>

        <div class="grid-4">
          <div class="field">
            <label>أيام الأسبوع</label>
            <select id="days">
              <option value="sun-thu" selected>الأحد → الخميس (5 أيام)</option>
              <option value="sun-wed">الأحد → الأربعاء (4 أيام)</option>
            </select>
          </div>
          <div class="field">
            <label>عدد الحصص/اليوم</label>
            <select id="periods">
              <option>5</option>
              <option>6</option>
              <option selected>7</option>
              <option>8</option>
            </select>
          </div>
          <div class="field">
            <label>بداية اليوم</label>
            <input id="startTime" type="time" value="07:00" />
          </div>
          <div class="field">
            <label>مدة الحصة (دقائق)</label>
            <select id="slotMins">
              <option>35</option>
              <option>45</option>
              <option selected>50</option>
              <option>55</option>
              <option>60</option>
            </select>
          </div>
        </div>

        <div class="grid-3" style="margin-top: 8px">
          <div class="field">
            <label>اتجاه الجدول</label>
            <select id="orient">
              <option value="periods-rows" selected>الأوقات = صفوف</option>
              <option value="periods-cols">الأوقات = أعمدة</option>
            </select>
          </div>
          <div class="field">
            <label>لون الجدول</label>
            <input id="tblColor" type="color" value="#3b82f6" />
          </div>
          <div class="field">
            <label>&nbsp;</label>
            <button class="btn" id="printCompact">طباعة مضغّطة</button>
          </div>
        </div>

        <div class="grid-3" style="margin-top: 8px">
          <div class="field">
            <label>شدّة اللون</label>
            <input
              id="tblIntensity"
              type="range"
              min="10"
              max="60"
              step="1"
              value="28"
            />
          </div>
          <div class="field">
            <label>شدّة الحدود</label>
            <input
              id="tblBorderIntensity"
              type="range"
              min="20"
              max="80"
              step="1"
              value="45"
            />
          </div>
          <div class="field">
            <label>&nbsp;</label>
            <span class="muted">تؤثر فورًا وتُحفظ تلقائيًا</span>
          </div>
        </div>

        <div class="row-actions">
          <button class="btn" id="addRow">+ حصة إضافية</button>
          <button class="btn" id="addCol">+ يوم إضافي (4→5)</button>
          <button class="btn" id="clearAll">مسح البيانات</button>
          <button class="btn" id="toggleColors">تلوين المواد</button>
          <button class="btn" id="exportCsv">تصدير CSV</button>
          <button class="btn" id="savePng">حفظ كصورة PNG</button>
          <button class="btn" id="print">طباعة</button>
        </div>

        <div class="legend">
          <span
            ><i></i> الخانات قابلة للتحرير: <strong>المادة</strong>،
            <strong>الصف/الفصل</strong>، <strong>الشعبة</strong></span
          >
          <span><i style="background: #86efac"></i> الحفظ تلقائي</span>
          <span
            ><i style="background: #fde68a"></i> ألوان المواد تحفظ
            تلقائيًا</span
          >
        </div>
      </section>

      <!-- الجدول (هذا سيظهر في الطباعة) -->
      <section class="card">
        <div class="table-wrap" id="tableWrap">
          <table class="schedule" id="tbl"></table>
        </div>
      </section>
    </main>

    <!-- footer component -->
    <div id="footer" data-component="components/footer.html"></div>

    <script>
      // سنة تلقائية في الفوتر
      (function () {
        var y = document.getElementById("year");
        if (y) y.textContent = new Date().getFullYear();
      })();
    </script>
    <div class="toast" id="toast"></div>

    <!-- ترتيب السكربتات مهم -->
    <script
      src="https://cdn.auth0.com/js/auth0-spa-js/2.1/auth0-spa-js.production.js"
      onerror="this.onerror=null;this.src='/assets/vendor/auth0-spa-js.production.js'"
    ></script>
    <!-- Component Loader -->
    <script src="assets/js/component-loader.js"></script>
    <script src="assets/js/navbar.js"></script>
    <script defer src="assets/js/require-auth.js"></script>
    <script defer src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script defer src="assets/js/supabase-client.js"></script>
    <script defer src="assets/js/storage.js"></script>
    <script defer src="app.js"></script>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"
    ></script>

    <!-- سكربت الصفحة -->
    <script src="assets/js/masar.js"></script>
  </body>
</html>
